CREATE TABLE KHOA (
    MAKHOA VARCHAR(4) PRIMARY KEY,
    TENKHOA VARCHAR(40),
    NGTLAP SMALLDATETIME,
    TRGKHOA CHAR(4)
);

CREATE TABLE GIAOVIEN (
    MAGV CHAR(4) PRIMARY KEY,
    HOTEN VARCHAR(40),
    HOCVI VARCHAR(40),
    HOCHAM VARCHAR(40),
    GIOITINH CHAR(3),
    NGSINH SMALLDATETIME,
    NGVL SMALLDATETIME,
    HESO MONEY,
    MUCLUONG MONEY,
    MAKHOA VARCHAR(4),
    FOREIGN KEY (MAKHOA) REFERENCES KHOA(MAKHOA)
);

CREATE TABLE MONHOC (
    MAMH VARCHAR(10) PRIMARY KEY,
    TENMH VARCHAR(40),
    TCLT TINYINT,
    TCH TINYINT,
    MAKHOA VARCHAR(4),
    FOREIGN KEY (MAKHOA) REFERENCES KHOA(MAKHOA)
);

CREATE TABLE DIEUKIEN (
    MAMH VARCHAR(10),
    MAMH_TRUOC VARCHAR(10),
    FOREIGN KEY (MAMH) REFERENCES MONHOC(MAMH),
    FOREIGN KEY (MAMH_TRUOC) REFERENCES MONHOC(MAMH)
);

CREATE TABLE LOP (
    MALOP VARCHAR(10) PRIMARY KEY,
    TENLOP VARCHAR(40),
	TRGLOP CHAR(5),
    SISO INT,
    MAGVCN CHAR(4),
    FOREIGN KEY (MAGVCN) REFERENCES GIAOVIEN(MAGV)
);

CREATE TABLE HOCVIEN (
    MAHV CHAR(10) PRIMARY KEY,
    TEN VARCHAR(40),
    GIOITINH CHAR(3),
    NGAYSINH SMALLDATETIME,
    NOISINH VARCHAR(40),
    MALOP VARCHAR(10),
    FOREIGN KEY (MALOP) REFERENCES LOP(MALOP)
);

CREATE TABLE GIANGDAY (
    MAGV CHAR(4),
    MALOP VARCHAR(10),
    MAMH VARCHAR(10),
    HOCKY VARCHAR(10),
    NAMHOC VARCHAR(10),
    TUNGAY SMALLDATETIME,
    DENNGAY SMALLDATETIME,
    PRIMARY KEY (MAGV, MALOP, MAMH),
    FOREIGN KEY (MAGV) REFERENCES GIAOVIEN(MAGV),
    FOREIGN KEY (MALOP) REFERENCES LOP(MALOP),
    FOREIGN KEY (MAMH) REFERENCES MONHOC(MAMH)
);

CREATE TABLE KETQUATHI (
    MAHV CHAR(10),
    MAMH VARCHAR(10),
    LANTHI TINYINT,
    NGTHI SMALLDATETIME,
    DIEM NUMERIC(4,2),
    KQUA VARCHAR(10),
    PRIMARY KEY (MAHV, MAMH, NGTHI),
    FOREIGN KEY (MAHV) REFERENCES HOCVIEN(MAHV),
    FOREIGN KEY (MAMH) REFERENCES MONHOC(MAMH)
);



--3
ALTER TABLE GIAOVIEN
ADD CONSTRAINT CHK_GIOITINHGV CHECK (GIOITINH IN ('Nam', 'Nu'));

ALTER TABLE HOCVIEN
ADD CONSTRAINT CHK_GIOITINHHV CHECK (GIOITINH IN ('Nam', 'Nu'));

--4
ALTER TABLE KETQUATHI
ADD CONSTRAINT CHK_DIEM CHECK (DIEM BETWEEN 0 AND 10);

--5
ALTER TABLE KETQUATHI
ADD CONSTRAINT CHK_KQUA CHECK ((KQUA = 'Dat' AND DIEM BETWEEN 5 AND 10) OR (KQUA = 'Khong Dat' AND DIEM < 5));

--6
ALTER TABLE KETQUATHI
ADD CONSTRAINT CHK_LANTHI CHECK (LANTHI < 3);

--7
ALTER TABLE GIANGDAY
ADD CONSTRAINT CHK_HKI CHECK (CAST(HOCKY AS INT) BETWEEN 1 AND 3);

--8
ALTER TABLE GIAOVIEN
ADD CONSTRAINT CHK_HVI CHECK (HOCVI IN ('CN', 'KS', 'ThS', 'TS', 'PTS'));

--BT2 Nhập dữ liệu
INSERT INTO KHOA VALUES ('KHMT', 'Khoa hoc may tinh', '2005-07-06', 'GV01');
INSERT INTO KHOA VALUES ('HTTT', 'He thong thong tin', '2005-07-06', 'GV02');
INSERT INTO KHOA VALUES ('CNPM', 'Cong nghe phan mem', '2005-07-06', 'GV04');
INSERT INTO KHOA VALUES ('MTT', 'Mang va truyen thong', '2005-10-20', 'GV03');
INSERT INTO KHOA VALUES ('KTMT', 'Ky thuat may tinh', '2005-12-20', NULL);

INSERT INTO GIAOVIEN VALUES ('GV01', 'Ho Thanh Son', 'PTS', 'GS', 'Nam', '1950-02-05', '2004-11-01', 5.00, 2250000, 'KHMT');
INSERT INTO GIAOVIEN VALUES ('GV02', 'Tran Tam Thanh', 'TS', 'PGS', 'Nam', '1965-12-17', '2004-04-20', 4.50, 2025000, 'HTTT');
INSERT INTO GIAOVIEN VALUES ('GV03', 'Do Nghiem Phung', 'TS', 'GS', 'Nu', '1950-08-01', '2004-09-23', 4.00, 1800000, 'CNPM');
INSERT INTO GIAOVIEN VALUES ('GV04', 'Tran Nam Son', 'TS', 'PGS', 'Nam', '1961-02-22', '2005-01-12', 4.50, 2025000, 'KTMT');
INSERT INTO GIAOVIEN VALUES ('GV05', 'Mai Thanh Danh', 'ThS', 'GV', 'Nam', '1958-03-12', '2005-01-12', 3.00, 1350000, 'HTTT');
INSERT INTO GIAOVIEN VALUES ('GV06', 'Tran Doan Hung', 'TS', 'GV', 'Nam', '1953-03-11', '2005-01-12', 4.50, 2025000, 'KHMT');
INSERT INTO GIAOVIEN VALUES ('GV07', 'Nguyen Minh Tien', 'ThS', 'GV', 'Nam', '1971-11-23', '2005-03-01', 4.00, 1800000, 'KHMT');
INSERT INTO GIAOVIEN VALUES ('GV08', 'Le Thi Tran', 'KS', '', 'Nu', '1974-03-26', '2005-03-01', 1.69, 760500, 'KHMT');
INSERT INTO GIAOVIEN VALUES ('GV09', 'Nguyen To Lan', 'ThS', 'GV', 'Nu', '1966-12-31', '2005-03-01', 4.00, 1800000, 'HTTT');
INSERT INTO GIAOVIEN VALUES ('GV10', 'Le Tran Anh Loan', 'KS', '', 'Nu', '1972-07-17', '2005-03-01', 1.86, 837000, 'CNPM');
INSERT INTO GIAOVIEN VALUES ('GV11', 'Ho Thanh Tung', 'CN', 'GV', 'Nam', '1980-01-12', '2005-05-15', 2.67, 1201500, 'MTT');
INSERT INTO GIAOVIEN VALUES ('GV12', 'Tran Van Anh', 'CN', '', 'Nu', '1981-03-29', '2005-05-15', 1.69, 760500, 'CNPM');
INSERT INTO GIAOVIEN VALUES ('GV13', 'Nguyen Linh Dan', 'CN', '', 'Nu', '1980-05-23', '2005-05-15', 1.69, 760500, 'KTMT');
INSERT INTO GIAOVIEN VALUES ('GV14', 'Truong Minh Chau', 'ThS', 'GV', 'Nu', '1976-11-30', '2005-05-15', 3.00, 1350000, 'MTT');
INSERT INTO GIAOVIEN VALUES ('GV15', 'Le Ha Thanh', 'ThS', 'GV', 'Nam', '1978-05-04', '2005-05-15', 3.00, 1350000, 'KHMT');

INSERT INTO MONHOC VALUES ('THDC', 'Tin hoc dai cuong', 4, 1, 'KHMT');
INSERT INTO MONHOC VALUES ('CTRR', 'Cau truc roi rac', 5, 0, 'KHMT');
INSERT INTO MONHOC VALUES ('CSDL', 'Co so du lieu', 3, 1, 'HTTT');
INSERT INTO MONHOC VALUES ('CTDLGT', 'Cau truc du lieu va giai thuat', 3, 1, 'KHMT');
INSERT INTO MONHOC VALUES ('PTTKTT', 'Phan tich thiet ke thuat toan', 3, 0, 'KHMT');
INSERT INTO MONHOC VALUES ('DHMT', 'Do hoa may tinh', 3, 1, 'KHMT');
INSERT INTO MONHOC VALUES ('KTMT', 'Kien truc may tinh', 3, 0, 'KTMT');
INSERT INTO MONHOC VALUES ('TKCSDL', 'Thiet ke co so du lieu', 3, 1, 'HTTT');
INSERT INTO MONHOC VALUES ('PTTKHTTT', 'Phan tich thiet ke he thong thong tin', 4, 1, 'HTTT');
INSERT INTO MONHOC VALUES ('HDH', 'He dieu hanh', 4, 0, 'KTMT');
INSERT INTO MONHOC VALUES ('NMCNPM', 'Nhap mon cong nghe phan mem', 3, 0, 'CNPM');
INSERT INTO MONHOC VALUES ('LTCFW', 'Lap trinh C for win', 3, 1, 'CNPM');
INSERT INTO MONHOC VALUES ('LTHDT', 'Lap trinh huong doi tuong', 3, 1, 'CNPM');

INSERT INTO LOP (MALOP, TENLOP, TRGLOP, SISO, MAGVCN) VALUES('K11','Lop 1 khoa 1','K1108',11,'GV07')
INSERT INTO LOP (MALOP, TENLOP, TRGLOP, SISO, MAGVCN) VALUES('K12','Lop 2 khoa 1','K1205',12,'GV09')
INSERT INTO LOP (MALOP, TENLOP, TRGLOP, SISO, MAGVCN) VALUES('K13','Lop 3 khoa 1','K1305',12,'GV14')

INSERT INTO HOCVIEN VALUES ('K1101', 'Nguyen Van A', 'Nam', '1986-01-27', 'TpHCM', 'K11');
INSERT INTO HOCVIEN VALUES ('K1102', 'Tran Ngoc Han', 'Nu', '1986-03-01', 'Kien Giang', 'K11');
INSERT INTO HOCVIEN VALUES ('K1103', 'Ha Duy Lap', 'Nam', '1986-04-18', 'Nghe An', 'K11');
INSERT INTO HOCVIEN VALUES ('K1104', 'Tran Ngoc Linh', 'Nu', '1986-03-30', 'Tay Ninh', 'K11');
INSERT INTO HOCVIEN VALUES ('K1105', 'Tran Minh Long', 'Nam', '1986-02-27', 'TpHCM', 'K11');
INSERT INTO HOCVIEN VALUES ('K1106', 'Le Nhat Minh', 'Nam', '1986-01-24', 'TpHCM', 'K11');
INSERT INTO HOCVIEN VALUES ('K1107', 'Nguyen Nhu Nhut', 'Nam', '1986-01-27', 'Ha Noi', 'K11');
INSERT INTO HOCVIEN VALUES ('K1108', 'Nguyen Manh Tam', 'Nam', '1986-02-27', 'Kien Giang', 'K11');
INSERT INTO HOCVIEN VALUES ('K1109', 'Phan Thi Thanh Tam', 'Nu', '1986-01-27', 'Vinh Long', 'K11');
INSERT INTO HOCVIEN VALUES ('K1110', 'Le Hoai Thuong', 'Nu', '1986-02-05', 'Can Tho', 'K11');
INSERT INTO HOCVIEN VALUES ('K1111', 'Le Ha Vinh', 'Nam', '1986-12-25', 'Vinh Long', 'K11');
INSERT INTO HOCVIEN VALUES ('K1201', 'Nguyen Van B', 'Nam', '1986-02-11', 'TpHCM', 'K12');
INSERT INTO HOCVIEN VALUES ('K1202', 'Nguyen Thi Kim Duyen', 'Nu', '1986-01-18', 'TpHCM', 'K12');
INSERT INTO HOCVIEN VALUES ('K1203', 'Tran Thi Kim Duyen', 'Nu', '1986-09-17', 'TpHCM', 'K12');
INSERT INTO HOCVIEN VALUES ('K1204', 'Truong My Hanh', 'Nu', '1986-05-19', 'Dong Nai', 'K12');
INSERT INTO HOCVIEN VALUES ('K1205', 'Nguyen Thanh Nam', 'Nam', '1986-04-17', 'TpHCM', 'K12');
INSERT INTO HOCVIEN VALUES ('K1206', 'Nguyen Thi Truc Thanh', 'Nu', '1986-03-04', 'Kien Giang', 'K12');
INSERT INTO HOCVIEN VALUES ('K1207', 'Tran Thi Bich Thuy', 'Nu', '1986-02-08', 'Nghe An', 'K12');
INSERT INTO HOCVIEN VALUES ('K1208', 'Huynh Thi Kim Trieu', 'Nu', '1986-04-08', 'Tay Ninh', 'K12');
INSERT INTO HOCVIEN VALUES ('K1209', 'Pham Thanh Trieu', 'Nam', '1986-02-23', 'TpHCM', 'K12');
INSERT INTO HOCVIEN VALUES ('K1210', 'Ngo Thanh Tuan', 'Nam', '1986-02-14', 'TpHCM', 'K12');
INSERT INTO HOCVIEN VALUES ('K1211', 'Do Thi Xuan', 'Nu', '1986-03-09', 'Ha Noi', 'K12');
INSERT INTO HOCVIEN VALUES ('K1212', 'Le Thi Phi Yen', 'Nu', '1986-03-12', 'TpHCM', 'K12');
INSERT INTO HOCVIEN VALUES ('K1301', 'Nguyen Thi Kim Cuc', 'Nu', '1986-06-09', 'Kien Giang', 'K13');
INSERT INTO HOCVIEN VALUES ('K1302', 'Truong Thi My Hien', 'Nu', '1986-03-18', 'Nghe An', 'K13');
INSERT INTO HOCVIEN VALUES ('K1303', 'Le Duc Hien', 'Nam', '1986-03-12', 'Tay Ninh', 'K13');
INSERT INTO HOCVIEN VALUES ('K1304', 'Le Quang Hien', 'Nam', '1986-04-18', 'TpHCM', 'K13');
INSERT INTO HOCVIEN VALUES ('K1305', 'Le Thi Huong', 'Nu', '1986-03-27', 'TpHCM', 'K13');
INSERT INTO HOCVIEN VALUES ('K1306', 'Nguyen Thai Huu', 'Nam', '1986-03-30', 'Ha Noi', 'K13');
INSERT INTO HOCVIEN VALUES ('K1307', 'Tran Minh Man', 'Nam', '1986-05-28', 'TpHCM', 'K13');
INSERT INTO HOCVIEN VALUES ('K1308', 'Nguyen Hieu Nghia', 'Nam', '1986-04-08', 'Kien Giang', 'K13');
INSERT INTO HOCVIEN VALUES ('K1309', 'Nguyen Trung Nghia', 'Nam', '1987-01-18', 'Nghe An', 'K13');
INSERT INTO HOCVIEN VALUES ('K1310', 'Tran Thi Hong Tham', 'Nu', '1986-04-22', 'Tay Ninh', 'K13');
INSERT INTO HOCVIEN VALUES ('K1311', 'Tran Minh Thuc', 'Nam', '1986-04-04', 'TpHCM', 'K13');
INSERT INTO HOCVIEN VALUES ('K1312', 'Nguyen Thi Kim Yen', 'Nu', '1986-09-07', 'TpHCM', 'K13');

INSERT INTO GIANGDAY (MAGV, MALOP, MAMH, HOCKY, NAMHOC, TUNGAY, DENNGAY) 
VALUES ('GV07', 'K11', 'THDC', 1, '2006', '2006-02-01', '2006-05-12');
INSERT INTO GIANGDAY (MAGV, MALOP, MAMH, HOCKY, NAMHOC, TUNGAY, DENNGAY) 
VALUES ('GV06', 'K12', 'THDC', 1, '2006', '2006-02-01', '2006-05-12');
INSERT INTO GIANGDAY (MAGV, MALOP, MAMH, HOCKY, NAMHOC, TUNGAY, DENNGAY) 
VALUES ('GV15', 'K13', 'THDC', 1, '2006', '2006-02-01', '2006-05-12');
INSERT INTO GIANGDAY (MAGV, MALOP, MAMH, HOCKY, NAMHOC, TUNGAY, DENNGAY) 
VALUES ('GV02', 'K11', 'CTRR', 1, '2006', '2006-09-01', '2006-05-17');
INSERT INTO GIANGDAY (MAGV, MALOP, MAMH, HOCKY, NAMHOC, TUNGAY, DENNGAY) 
VALUES ('GV02', 'K12', 'CTRR', 1, '2006', '2006-09-01', '2006-05-17');
INSERT INTO GIANGDAY (MAGV, MALOP, MAMH, HOCKY, NAMHOC, TUNGAY, DENNGAY) 
VALUES ('GV08', 'K13', 'CTRR', 1, '2006', '2006-09-01', '2006-05-17');
INSERT INTO GIANGDAY (MAGV, MALOP, MAMH, HOCKY, NAMHOC, TUNGAY, DENNGAY) 
VALUES ('GV05', 'K11', 'CSDL', 2, '2006', '2006-06-01', '2006-07-15');
INSERT INTO GIANGDAY (MAGV, MALOP, MAMH, HOCKY, NAMHOC, TUNGAY, DENNGAY) 
VALUES ('GV09', 'K12', 'CSDL', 2, '2006', '2006-06-01', '2006-07-15');
INSERT INTO GIANGDAY (MAGV, MALOP, MAMH, HOCKY, NAMHOC, TUNGAY, DENNGAY) 
VALUES ('GV15', 'K13', 'CTDLGT', 2, '2006', '2006-06-01', '2006-07-15');
INSERT INTO GIANGDAY (MAGV, MALOP, MAMH, HOCKY, NAMHOC, TUNGAY, DENNGAY) 
VALUES ('GV05', 'K13', 'CSDL', 3, '2006', '2006-08-01', '2006-12-15');
INSERT INTO GIANGDAY (MAGV, MALOP, MAMH, HOCKY, NAMHOC, TUNGAY, DENNGAY) 
VALUES ('GV07', 'K13', 'DHMT', 3, '2006', '2006-08-01', '2006-12-15');
INSERT INTO GIANGDAY (MAGV, MALOP, MAMH, HOCKY, NAMHOC, TUNGAY, DENNGAY) 
VALUES ('GV15', 'K11', 'CTDLGT', 3, '2006', '2006-08-01', '2006-12-15');
INSERT INTO GIANGDAY (MAGV, MALOP, MAMH, HOCKY, NAMHOC, TUNGAY, DENNGAY) 
VALUES ('GV15', 'K12', 'CTDLGT', 3, '2006', '2006-08-01', '2006-12-15');
INSERT INTO GIANGDAY (MAGV, MALOP, MAMH, HOCKY, NAMHOC, TUNGAY, DENNGAY) 
VALUES ('GV04', 'K11', 'HDH', 1, '2007', '2007-02-01', '2007-02-18');
INSERT INTO GIANGDAY (MAGV, MALOP, MAMH, HOCKY, NAMHOC, TUNGAY, DENNGAY) 
VALUES ('GV04', 'K12', 'HDH', 1, '2007', '2007-02-01', '2007-03-20');
INSERT INTO GIANGDAY (MAGV, MALOP, MAMH, HOCKY, NAMHOC, TUNGAY, DENNGAY) 
VALUES ('GV07', 'K11', 'DHMT', 1, '2007', '2007-02-18', '2007-03-20');

INSERT INTO DIEUKIEN VALUES ('CSDL', 'CTRR');
INSERT INTO DIEUKIEN VALUES ('CSDL', 'CTDLGT');
INSERT INTO DIEUKIEN VALUES ('CTDLGT', 'THDC');
INSERT INTO DIEUKIEN VALUES ('PTTKTT', 'THDC');
INSERT INTO DIEUKIEN VALUES ('PTTKTT', 'CTDLGT');
INSERT INTO DIEUKIEN VALUES ('DHMT', 'THDC');
INSERT INTO DIEUKIEN VALUES ('LTHDT', 'THDC');
INSERT INTO DIEUKIEN VALUES ('PTTKHTTT', 'CSDL');

INSERT INTO KETQUATHI VALUES ('K1101', 'CSDL', 1, '2006-07-20', 10.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1101', 'CTDLGT', 1, '2006-12-28', 9.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1101', 'THDC', 1, '2006-05-20', 9.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1101', 'CTRR', 1, '2006-05-13', 9.50, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1102', 'CSDL', 1, '2006-07-20', 4.00, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1102', 'CSDL', 2, '2006-07-27', 4.25, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1102', 'CSDL', 3, '2006-08-10', 4.50, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1102', 'CTDLGT', 1, '2006-12-28', 4.50, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1102', 'CTDLGT', 2, '2007-01-05', 4.00, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1102', 'CTDLGT', 3, '2007-01-15', 6.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1102', 'THDC', 1, '2006-05-20', 5.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1102', 'CTRR', 1, '2006-05-13', 7.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1103', 'CSDL', 1, '2006-07-20', 3.50, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1103', 'CSDL', 2, '2006-07-27', 8.25, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1103', 'CTDLGT', 1, '2006-12-28', 7.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1103', 'THDC', 1, '2006-05-20', 8.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1103', 'CTRR', 1, '2006-05-13', 6.50, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1104', 'CSDL', 1, '2006-07-20', 3.75, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1104', 'CTDLGT', 1, '2006-12-28', 4.00, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1104', 'THDC', 1, '2006-05-20', 4.00, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1104', 'CTRR', 1, '2006-05-13', 4.00, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1104', 'CTRR', 2, '2006-05-20', 3.50, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1104', 'CTRR', 3, '2006-06-30', 4.00, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1201', 'CSDL', 1, '2006-07-20', 6.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1201', 'CTDLGT', 1, '2006-12-28', 5.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1201', 'THDC', 1, '2006-05-20', 8.50, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1201', 'CTRR', 1, '2006-05-13', 9.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1202', 'CSDL', 1, '2006-07-20', 8.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1202', 'CTDLGT', 1, '2006-12-28', 4.00, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1202', 'CTDLGT', 2, '2007-01-05', 5.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1202', 'THDC', 1, '2006-05-20', 4.00, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1202', 'THDC', 2, '2006-05-27', 4.00, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1202', 'CTRR', 1, '2006-05-13', 3.00, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1202', 'CTRR', 2, '2006-05-20', 4.00, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1202', 'CTRR', 3, '2006-06-30', 6.25, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1203', 'CSDL', 1, '2006-07-20', 9.25, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1203', 'CTDLGT', 1, '2006-12-28', 9.50, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1203', 'THDC', 1, '2006-05-20', 10.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1203', 'CTRR', 1, '2006-05-13', 10.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1204', 'CSDL', 1, '2006-07-20', 8.50, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1204', 'CTDLGT', 1, '2006-12-28', 6.75, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1204', 'THDC', 1, '2006-05-20', 4.00, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1204', 'CTRR', 1, '2006-05-13', 6.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1301', 'CSDL', 1, '2006-12-20', 4.25, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1301', 'CTDLGT', 1, '2006-07-25', 8.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1301', 'THDC', 1, '2006-05-20', 7.75, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1301', 'CTRR', 1, '2006-05-13', 8.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1302', 'CSDL', 1, '2006-12-20', 6.75, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1302', 'CTDLGT', 1, '2006-07-25', 5.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1302', 'THDC', 1, '2006-05-20', 8.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1302', 'CTRR', 1, '2006-05-13', 8.50, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1303', 'CSDL', 1, '2006-12-20', 4.00, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1303', 'CTDLGT', 1, '2006-07-25', 4.50, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1303', 'CTDLGT', 2, '2006-08-07', 4.00, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1303', 'CTDLGT', 3, '2006-08-15', 4.25, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1303', 'THDC', 1, '2006-05-20', 4.50, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1303', 'CTRR', 1, '2006-05-13', 3.25, 'Khong Dat');
INSERT INTO KETQUATHI VALUES ('K1303', 'CTRR', 2, '2006-05-20', 5.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1304', 'CSDL', 1, '2006-12-20', 7.75, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1304', 'CTDLGT', 1, '2006-07-25', 9.75, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1304', 'THDC', 1, '2006-05-20', 5.50, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1304', 'CTRR', 1, '2006-05-13', 5.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1305', 'CSDL', 1, '2006-12-20', 9.25, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1305', 'CTDLGT', 1, '2006-07-25', 10.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1305', 'THDC', 1, '2006-05-20', 8.00, 'Dat');
INSERT INTO KETQUATHI VALUES ('K1305', 'CTRR', 1, '2006-05-13', 10.00, 'Dat');

--BT4
--11. Học viên ít nhất là 18 tuổi.
ALTER TABLE HOCVIEN
ADD CONSTRAINT CHK_HV CHECK (YEAR(NGAYSINH) <= YEAR(GETDATE()) - 18);

--12. Giảng dạy một môn học ngày bắt đầu (TUNGAY) phải nhỏ hơn ngày kết thúc (DENNGAY).
ALTER TABLE GIANGDAY
ADD CONSTRAINT CHK_GIANGDAY CHECK (TUNGAY < DENNGAY);

--13. Giáo viên khi vào làm ít nhất là 22 tuổi.
ALTER TABLE GIAOVIEN
ADD CONSTRAINT CHECK_VAOLAM CHECK (YEAR(NGVL) - YEAR(NGSINH) >= 22);

--14. Tất cả các môn học đều có số tín chỉ lý thuyết và tín chỉ thực hành chênh lệch nhau không quá 3.
ALTER TABLE MONHOC
ADD CONSTRAINT CHECK_TC CHECK (ABS(TCLT - TCH) <= 3);

--BT6
--1. In ra danh sách (mã học viên, họ tên, ngày sinh, mã lớp) lớp trưởng của các lớp.
SELECT HOCVIEN.MAHV, HOCVIEN.TEN, HOCVIEN.NGAYSINH, HOCVIEN.MALOP
FROM HOCVIEN, LOP
WHERE LOP.TRGLOP = HOCVIEN.MAHV;

--2. In ra bảng điểm khi thi (mã học viên, họ tên, lần thi, điểm số) môn CTRR của lớp “K12”, sắp xếp theo tên, họ học viên.
SELECT HOCVIEN.MAHV, HOCVIEN.TEN, KETQUATHI.LANTHI, KETQUATHI.DIEM
FROM HOCVIEN, KETQUATHI
WHERE KETQUATHI.MAHV = HOCVIEN.MAHV
AND HOCVIEN.MALOP = 'K12'
AND KETQUATHI.MAMH = 'CTRR'
ORDER BY HOCVIEN.TEN, HOCVIEN.MAHV;

--3. In ra danh sách những học viên (mã học viên, họ tên) và những môn học mà học viên đó thi lần thứ nhất đã đạt.
SELECT HOCVIEN.MAHV, HOCVIEN.TEN, MONHOC.TENMH
FROM HOCVIEN, KETQUATHI, MONHOC
WHERE KETQUATHI.MAHV = HOCVIEN.MAHV
AND KETQUATHI.MAMH = MONHOC.MAMH
AND LANTHI = 1 AND KQUA = 'Dat';

--4. In ra danh sách học viên (mã học viên, họ tên) của lớp “K11” thi môn CTRR không đạt (ở lần thi 1).
SELECT HOCVIEN.MAHV, HOCVIEN.TEN
FROM HOCVIEN, KETQUATHI
WHERE KETQUATHI.MAHV = HOCVIEN.MAHV
AND HOCVIEN.MALOP = 'K11'
AND KETQUATHI.MAMH = 'CTRR'
AND KETQUATHI.LANTHI = 1 AND KQUA = 'Khong Dat';

--5. * Danh sách học viên (mã học viên, họ tên) của lớp “K” thi môn CTRR không đạt (ở tất cả các lần thi).
SELECT DISTINCT HOCVIEN.MAHV, HOCVIEN.TEN
FROM HOCVIEN, KETQUATHI
WHERE KETQUATHI.MAHV = HOCVIEN.MAHV
AND KETQUATHI.MAMH = 'CTRR'
AND HOCVIEN.MAHV NOT IN (
    SELECT MAHV
    FROM KETQUATHI
    WHERE MAMH = 'CTRR'
    AND KQUA = 'Dat'
);
